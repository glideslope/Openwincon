package mcnl;

import java.util.Vector;

public class Player {
    boolean m_binaryOffloading;
    boolean m_isOffloaded;

    // system
    int m_id; // node id
    int m_currentGopIndex;
    boolean m_join;
    double m_avrPLR;
    double m_weightedAvrPLR;
    double m_joinTime;
    int m_currentPlayGOPIndex;

    // fountain code

    // WiFi
    int m_sendPktNum_WiFi;
    int m_recvPktNum_WiFi;
    int m_sendTotalPktNum_WiFi;
    int m_recvTotalPktNum_WiFi;
    int m_sizeByte_WiFi;
    int m_sizeByteTotal_WiFi;
    double m_plr_WiFi;
    double m_weightedPlr_WiFi;
    int m_rtt_WiFi; // milliseconds
    int m_estimatedRtt_WiFi;
    int m_bw_WiFi;
    int m_maxPkt_WiFi;
    int m_tempMaxPkt_WiFi;
    int m_pkt_WiFi;
    int m_bwEst_WiFi;
    double m_recvPktTime_WiFi;
    Vector m_vec_bw_WiFi;
    double m_recvPktTotalTime_WiFi;
    int m_bwSumWiFi;
    double m_periodPacket_WiFi;

    // LTE
    int m_sendPktNum_LTE;
    int m_recvPktNum_LTE;
    int m_sendTotalPktNum_LTE;
    int m_recvTotalPktNum_LTE;
    int m_sizeByte_LTE;
    int m_sizeByteTotal_LTE;
    double m_plr_LTE;
    double m_weightedPlr_LTE;
    int m_rtt_LTE; // ms
    int m_estimatedRtt_LTE;
    int m_bw_LTE; // kbps
    int m_maxPkt_LTE;
    int m_tempMaxPkt_LTE;
    int m_pkt_LTE; // bid for auction
    int m_bwEst_LTE; // kbps
    double m_recvPktTime_LTE;
//    Ipv4Address m_ueAddr;
    Vector m_vec_bw_LTE;
    double m_recvPktTotalTime_LTE;
    int m_bwSumLTE;
    double m_periodPacket_LTE;
    short m_cellID;    // 170308 major revision

    // park : bargaining
    double m_qualBP;
    double m_socialBP;
    double m_BP;
    double m_macroRsc;
    double m_smallRsc;
    double m_A;
    double m_B;

    // auction
    int m_round;
    double m_price;
    int m_allocPkt_LTE;
    double m_allocPrice;
    boolean m_sendBid; // send bid to seller ?
    boolean m_getBidResults; // get bid results from seller ?
    boolean m_needAuction;

    boolean m_isSamewithPreviousBid;
    boolean m_isMyTurn;

    int m_upperBoundPkt;
    int m_lowerBoundPkt;

    double m_omega;

    // problem formulation
    int m_optPkt_LTE;
    int m_optPkt_WiFi;
    double m_optBitrate;
    double m_optPSNR;
    double m_optDistortion;
    double m_optCoderate;
    double m_optResourceValuation;

    int m_index;

    /////////////////////////////////////////////////////////////////////////////////
    static final int BITRATE_UPPER_BOUND = 6000; //kbps
    // video
    static final int numOfQualityLevels = 10;
    static final int FRAME_RATE = 24;
    static final int FRAME_PER_GOP = 24;
    static final int DELAY_CONSTRAINTS = 1000;


    static final int PACKET_SIZE = 1024;
    static final double RTT_ALPHA = 0.125;
    static final double PLR_ALPHA = 0.125;

    // fountain code
    static final double PIVALUE = 3.14159265358979323846;
    static final double CODERATE_MIN = 0.7;
    static final double CODERATE_MAX = 0.99;
    static final double CODERATE_STEP = 0.001;
    static final double FOUNTAIN_CONSTRAINTS = 0.001;

    // proposed system
    static final double LAMBDA = 0.3; // not used
    static final double AUCTION_EPSILON = 0.01; // not used
    static final double AUCTION_DELTA = 0.05; // not used
    static final int BIDDING_PRICE_EPSILON = 20; // not used

    static final int COUNT_POINT = 3;

    static final boolean IS_BISECTION = false;
    static final boolean IS_GREEDY = false;
    static final boolean WITH_OPPONENT_PROFILE = false;
    static final boolean WITH_OPPONENT_PROFILE_OPTIMAL = false;
    static final boolean WITH_OPPONENT_PROFILE_ANAL = false;

    static final boolean WITH_BINARY_WIFI_OFFLOADING = false;       // single WiFi without auction (6 UEs)
    static final boolean WITH_BINARY_LTE_OFFLOADING = false;       // single LTE without auction (4 UEs)
    static final boolean WITH_SINGLE_PSP_AUCTION = false;              // single LTE with auction (10 UEs)

    static final double PSP_EPSILON = 0.001; // 0.001
    static final double DELTA_PSNR = 0.1;
    static final double OMEGA = 0.5; // 160919 new algorithm
    static final double TAU = 0.005; // 160919 new algorithm

    static final int NUMBER_OF_VIDEO = 2;
    /////////////////////////////////////////////////////////////////////////////////

    static final double [][] ALPHA = {
        { 13823.2501,21352.0892,38535.0851,278760.1037,241156.4103,237433.873,1271503.314,1620329.384,1683333.863,3481572.542,362326.0422,168252.2808,75691.1479,27530.3236,48193.7759,13823.2501,21352.0892,38535.0851,278760.1037,241156.4103,237433.873,1271503.314,1620329.384,1683333.863,3481572.542,362326.0422,168252.2808,75691.1479,27530.3236,48193.7759,13823.2501,21352.0892,38535.0851,278760.1037,241156.4103,237433.873,1271503.314,1620329.384,1683333.863,3481572.542,362326.0422,168252.2808,75691.1479,27530.3236,48193.7759,13823.2501,21352.0892,38535.0851,278760.1037,241156.4103,237433.873,1271503.314,1620329.384,1683333.863,3481572.542,362326.0422,168252.2808,75691.1479,27530.3236,48193.7759},
        { 40335.9461,70535.6745,728861.5362,1938769.908,1580828.582,342706.6984,484447.6011,315918.8998,209336.9832,319605.5563,239099.1518,527849.2998,697125.0293,1382316.714,1590672.746,1626097.274,1582856.588,1287872.328,1785515.994,2802751.593,40335.9461,70535.6745,728861.5362,1938769.908,1580828.582,342706.6984,484447.6011,315918.8998,209336.9832,319605.5563,239099.1518,527849.2998,697125.0293,1382316.714,1590672.746,1626097.274,1582856.588,1287872.328,1785515.994,2802751.593,40335.9461,70535.6745,728861.5362,1938769.908,1580828.582,342706.6984,484447.6011,315918.8998,209336.9832,319605.5563,239099.1518,527849.2998,697125.0293,1382316.714,1590672.746,1626097.274,1582856.588,1287872.328,1785515.994,2802751.593}
    };

    static final double [][] BETA = {
        { -0.959,-0.9141,-1.057,-1.3999,-1.3865,-1.3978,-1.7029,-1.7802,-1.8101,-1.9196,-1.4912,-1.3845,-1.2368,-1.0585,-1.148,-0.959,-0.9141,-1.057,-1.3999,-1.3865,-1.3978,-1.7029,-1.7802,-1.8101,-1.9196,-1.4912,-1.3845,-1.2368,-1.0585,-1.148,-0.959,-0.9141,-1.057,-1.3999,-1.3865,-1.3978,-1.7029,-1.7802,-1.8101,-1.9196,-1.4912,-1.3845,-1.2368,-1.0585,-1.148,-0.959,-0.9141,-1.057,-1.3999,-1.3865,-1.3978,-1.7029,-1.7802,-1.8101,-1.9196,-1.4912,-1.3845,-1.2368,-1.0585,-1.148},
        { -1.2406,-1.306,-1.7173,-1.8804,-1.8352,-1.5177,-1.6059,-1.5162,-1.4357,-1.5131,-1.4483,-1.569,-1.5874,-1.6924,-1.7126,-1.7465,-1.7523,-1.7055,-1.766,-1.862,-1.2406,-1.306,-1.7173,-1.8804,-1.8352,-1.5177,-1.6059,-1.5162,-1.4357,-1.5131,-1.4483,-1.569,-1.5874,-1.6924,-1.7126,-1.7465,-1.7523,-1.7055,-1.766,-1.862,-1.2406,-1.306,-1.7173,-1.8804,-1.8352,-1.5177,-1.6059,-1.5162,-1.4357,-1.5131,-1.4483,-1.569,-1.5874,-1.6924,-1.7126,-1.7465,-1.7523,-1.7055,-1.766,-1.862}
    };
    static final double[][] smallRsc = {
        { 513, 475, 528, 541, 581, 643, 694, 719, 749, 788, 791, 788, 783, 727, 758, 812, 854, 914, 913, 891, 919, 956, 1035, 996, 1017, 1098, 1093, 1046, 1116, 1132, 1064, 1020, 984, 1026, 993, 981, 1007, 943, 924, 924, 910, 938, 931, 928, 967, 946, 950, 923, 934, 967, 1033, 991, 980, 892, 950, 987, 940, 906, 923, 923, 925, 980, 970, 969, 931, 883, 842, 898, 899, 915, 943, 868, 845, 894, 841, 810, 834, 824, 817, 902, 920, 963, 942, 929, 971, 999, 948, 961, 1010, 1031, 1058, 1059, 1059, 1026, 1045, 1093, 1110, 1096, 1145, 1154, 1171, 1164, 1200, 1218, 1233, 1253, 1287, 1344, 1362, 1350, 1346, 1309, 1294, 1348, 1340, 1395, 1393, 1373, 1374, 1385, 1440, 1396, 1331, 1361, 1360, 1285, 1271, 1341, 1330, 1344, 1334, 1313, 1266, 1223, 1244, 1244, 1286, 1241, 1235, 1243, 1196, 1237, 1248, 1253, 1263, 1260, 1287, 1217, 1165, 1120, 1051, 1100, 1078, 1066, 1074, 1111, 1110, 1112, 1167, 1135, 1104, 1070, 1011, 1000, 967, 967, 963, 986, 1051, 1023, 1023, 1054, 1056, 984, 1016, 1001, 948, 987, 1025, 1062, 1068, 1114, 1060, 1041, 1003, 936, 922, 919, 887, 892, 911, 891, 910, 849, 803, 809, 784, 727, 766, 741, 734, 651, 604, 675, 702, 754, 743, 680, 637, 617, 599, 600, 622, 695, 656, 613, 659, 697, 673, 695, 700, 778, 755, 760, 690, 659, 677, 631, 553, 565, 528, 468, 438, 478, 507, 547, 577, 565, 544, 474, 507, 454, 434, 489, 471, 402, 393, 392, 336, 326, 306, 361, 309, 332, 324, 406, 400, 384, 304, 264, 296, 325, 309, 314, 286, 241, 170, 153, 98, 176, 210, 210, 212, 222, 241, 231, 267, 340, 388, 381, 376, 342, 278, 352, 348, 397, 357, 338, 309, 262, 345, 300, 318, 338, 320, 344, 319, 300, 294, 236, 209 },
        { 479, 498, 517, 553, 507, 576, 610, 602, 648, 673, 715, 698, 684, 709, 758, 722, 634, 672, 725, 699, 662, 661, 694, 733, 766, 715, 735, 728, 756, 786, 837, 814, 802, 758, 771, 789, 831, 848, 910, 854, 884, 897, 892, 849, 914, 900, 975, 915, 993, 1047, 1047, 1024, 1005, 1025, 1018, 998, 1020, 1018, 1034, 1114, 1118, 1109, 1118, 1151, 1130, 1175, 1184, 1209, 1245, 1244, 1246, 1230, 1213, 1192, 1189, 1157, 1170, 1269, 1243, 1229, 1214, 1214, 1150, 1078, 1068, 1046, 1132, 1161, 1183, 1143, 1118, 1106, 1131, 1100, 1116, 1119, 1073, 1128, 1162, 1182, 1141, 1182, 1122, 1096, 1076, 1117, 1104, 1104, 1138, 1184, 1197, 1137, 1138, 1149, 1202, 1163, 1176, 1144, 1068, 1080, 1168, 1187, 1121, 1086, 1083, 1059, 1031, 1125, 1167, 1193, 1203, 1240, 1170, 1075, 1034, 1067, 1074, 1059, 1070, 1072, 1071, 1105, 1167, 1146, 1100, 1091, 1138, 1176, 1150, 1203, 1130, 1117, 1113, 1176, 1150, 1145, 1169, 1194, 1140, 1153, 1161, 1219, 1152, 1127, 1033, 982, 1024, 1013, 1019, 1052, 1063, 1050, 1064, 1075, 1095, 1134, 1106, 1149, 1123, 1183, 1205, 1131, 1179, 1190, 1213, 1189, 1092, 1148, 1159, 1148, 1120, 1122, 1100, 1056, 1016, 1082, 1058, 1097, 1108, 1103, 1162, 1129, 1058, 1064, 1113, 1166, 1221, 1254, 1240, 1177, 1202, 1161, 1145, 1225, 1257, 1162, 1151, 1198, 1160, 1129, 1160, 1111, 1095, 1059, 1045, 1099, 1051, 1056, 1051, 1084, 1028, 1037, 1049, 1026, 966, 973, 1020, 1091, 1057, 1051, 1046, 986, 1017, 1016, 963, 1042, 1044, 1040, 1007, 1033, 994, 1007, 995, 982, 1062, 1072, 1066, 1056, 1026, 1057, 1071, 1031, 1026, 1081, 1060, 1141, 1160, 1199, 1139, 1082, 1074, 1077, 1136, 1127, 1107, 1156, 1187, 1201, 1174, 1245, 1287, 1320, 1329, 1232, 1287, 1293, 1290, 1304, 1267, 1265, 1234, 1202, 1128, 1140, 1123, 1114, 1152, 1150, 1163, 1145, 1216 },
        { 524, 451, 460, 385, 452, 388, 380, 431, 428, 483, 441, 463, 477, 499, 465, 521, 524, 503, 497, 412, 420, 375, 327, 317, 340, 380, 420, 435, 461, 450, 493, 454, 398, 441, 485, 463, 446, 441, 427, 408, 399, 408, 403, 483, 503, 520, 486, 432, 363, 379, 292, 238, 286, 272, 250, 199, 232, 258, 252, 270, 238, 175, 234, 230, 237, 263, 319, 272, 328, 351, 252, 220, 224, 176, 109, 168, 72, 77, 65, 55, 2, 10, 10, 10, 10, 38, 64, 48, 43, 10, 89, 182, 234, 244, 273, 304, 325, 306, 351, 403, 345, 334, 323, 326, 281, 288, 376, 387, 359, 394, 363, 356, 344, 371, 346, 367, 336, 318, 336, 296, 327, 328, 276, 270, 319, 311, 331, 307, 322, 272, 278, 292, 293, 312, 286, 303, 299, 366, 371, 327, 327, 349, 369, 376, 394, 378, 387, 394, 394, 371, 383, 385, 440, 414, 454, 425, 395, 359, 399, 409, 367, 337, 342, 413, 438, 456, 436, 370, 378, 367, 361, 376, 375, 356, 433, 437, 479, 484, 505, 585, 553, 497, 555, 626, 579, 623, 629, 643, 568, 639, 663, 671, 656, 641, 710, 639, 648, 662, 685, 706, 685, 780, 720, 758, 736, 762, 804, 835, 825, 757, 794, 809, 807, 792, 806, 802, 877, 843, 836, 877, 866, 866, 812, 764, 694, 662, 592, 618, 662, 702, 765, 667, 657, 668, 655, 600, 546, 521, 509, 545, 544, 584, 574, 522, 506, 469, 503, 575, 546, 585, 629, 599, 569, 567, 612, 660, 688, 712, 729, 723, 778, 740, 692, 662, 688, 679, 626, 584, 595, 505, 460, 449, 451, 515, 555, 532, 484, 462, 434, 359, 418, 362, 370, 425, 505, 550, 507, 521, 431, 460, 483, 487, 421, 367, 313, 237, 308, 237, 273, 269, 319 },
        { 548, 481, 532, 487, 462, 422, 383, 369, 420, 477, 487, 553, 535, 593, 654, 676, 665, 679, 635, 586, 645, 621, 675, 676, 731, 740, 719, 685, 728, 665, 691, 660, 694, 687, 656, 584, 562, 496, 543, 505, 515, 531, 524, 589, 626, 608, 567, 510, 462, 400, 411, 406, 401, 407, 330, 298, 257, 249, 216, 233, 220, 269, 277, 236, 182, 165, 162, 219, 210, 242, 238, 224, 191, 110, 91, 171, 145, 71, 156, 150, 199, 252, 287, 305, 320, 300, 313, 355, 419, 455, 370, 308, 289, 219, 285, 340, 264, 201, 238, 210, 122, 169, 248, 200, 244, 227, 229, 226, 205, 173, 197, 242, 200, 155, 160, 209, 198, 227, 287, 291, 220, 213, 294, 264, 207, 260, 350, 313, 287, 275, 274, 277, 292, 299, 289, 299, 338, 399, 442, 369, 307, 290, 314, 317, 338, 285, 239, 323, 343, 316, 245, 292, 244, 223, 242, 307, 301, 229, 283, 271, 216, 220, 278, 290, 256, 225, 157, 243, 221, 257, 219, 200, 269, 315, 348, 352, 305, 369, 430, 488, 464, 439, 489, 480, 472, 518, 476, 544, 530, 594, 606, 573, 554, 476, 393, 390, 460, 488, 522, 552, 479, 470, 521, 530, 556, 523, 458, 476, 470, 475, 409, 404, 365, 359, 416, 439, 484, 462, 413, 437, 475, 479, 458, 396, 386, 458, 444, 463, 458, 397, 426, 426, 366, 277, 308, 297, 260, 281, 259, 282, 241, 213, 256, 218, 196, 150, 98, 168, 172, 131, 155, 136, 140, 131, 97, 103, 155, 179, 183, 162, 108, 71, 51, 33, 83, 32, 26, 29, 27, 10, 53, 36, 26, 27, 24, 46, 75, 58, 79, 92, 23, 10, 9, 28, 10, 44, 70, 81, 28, 4, 10, 13, 10, 3, 28, 30, 10, 10, 10, 4, 21 },
        { 678, 643, 664, 700, 735, 787, 824, 866, 778, 764, 801, 835, 886, 909, 884, 960, 985, 937, 870, 888, 844, 877, 933, 956, 966, 969, 908, 868, 813, 787, 763, 796, 732, 698, 701, 769, 770, 752, 663, 707, 661, 692, 729, 815, 905, 954, 909, 868, 952, 993, 984, 1011, 946, 889, 896, 938, 970, 970, 997, 1011, 1044, 1099, 1088, 1113, 1049, 1048, 1030, 1096, 1112, 1068, 1000, 1023, 983, 1012, 997, 941, 1024, 991, 1009, 1003, 964, 891, 846, 826, 860, 881, 856, 937, 955, 1025, 1094, 1037, 1012, 1058, 1138, 1202, 1250, 1160, 1182, 1250, 1225, 1232, 1221, 1200, 1251, 1223, 1294, 1329, 1306, 1300, 1241, 1204, 1162, 1120, 1111, 1130, 1148, 1120, 1173, 1180, 1174, 1183, 1231, 1205, 1187, 1220, 1247, 1253, 1331, 1310, 1336, 1355, 1299, 1273, 1316, 1361, 1344, 1331, 1409, 1455, 1439, 1393, 1390, 1402, 1454, 1396, 1328, 1411, 1331, 1363, 1425, 1405, 1351, 1429, 1508, 1538, 1539, 1541, 1578, 1606, 1635, 1650, 1646, 1601, 1551, 1546, 1532, 1520, 1563, 1536, 1526, 1460, 1513, 1475, 1405, 1400, 1411, 1435, 1413, 1425, 1423, 1460, 1463, 1402, 1366, 1369, 1417, 1484, 1499, 1438, 1492, 1507, 1579, 1508, 1539, 1492, 1417, 1386, 1395, 1330, 1352, 1406, 1462, 1522, 1584, 1592, 1609, 1596, 1503, 1485, 1419, 1464, 1382, 1338, 1365, 1275, 1309, 1223, 1165, 1242, 1174, 1240, 1193, 1204, 1217, 1284, 1283, 1333, 1297, 1265, 1239, 1294, 1335, 1328, 1290, 1333, 1257, 1300, 1364, 1340, 1353, 1414, 1444, 1436, 1446, 1505, 1470, 1466, 1512, 1549, 1521, 1537, 1471, 1504, 1480, 1516, 1607, 1546, 1578, 1567, 1533, 1624, 1596, 1609, 1593, 1611, 1600, 1610, 1629, 1684, 1632, 1541, 1540, 1477, 1412, 1472, 1476, 1460, 1498, 1524, 1546, 1547, 1607, 1647, 1681, 1675, 1708, 1746, 1724, 1715, 1648, 1626, 1617, 1696, 1759, 1666, 1712, 1698, 1691, 1673, 1668 },

        { 646, 645, 716, 742, 760, 781, 843, 839, 782, 715, 731, 666, 622, 663, 578, 545, 544, 541, 518, 551, 555, 510, 516, 518, 489, 491, 503, 535, 489, 441, 406, 489, 488, 519, 585, 517, 494, 477, 558, 593, 596, 544, 558, 556, 534, 577, 529, 603, 620, 549, 511, 519, 464, 557, 564, 556, 512, 510, 545, 524, 480, 523, 497, 535, 553, 505, 529, 500, 445, 430, 355, 325, 368, 441, 483, 436, 444, 446, 509, 542, 540, 458, 461, 492, 445, 482, 501, 489, 467, 527, 498, 521, 508, 550, 488, 502, 513, 458, 473, 529, 492, 493, 552, 554, 548, 619, 705, 730, 698, 639, 697, 695, 741, 818, 788, 832, 799, 787, 864, 889, 850, 836, 779, 735, 662, 640, 642, 672, 691, 715, 761, 786, 743, 748, 689, 625, 634, 576, 644, 623, 592, 579, 630, 617, 593, 549, 555, 513, 599, 557, 601, 607, 640, 681, 687, 696, 656, 660, 670, 743, 665, 604, 622, 617, 649, 656, 697, 703, 721, 702, 644, 649, 715, 708, 696, 750, 777, 781, 792, 744, 753, 770, 818, 819, 804, 830, 811, 855, 829, 776, 725, 753, 810, 850, 856, 798, 786, 828, 877, 794, 805, 764, 794, 731, 739, 691, 610, 627, 601, 601, 526, 530, 536, 576, 596, 510, 518, 521, 477, 497, 514, 540, 532, 511, 580, 617, 666, 676, 702, 692, 758, 763, 745, 681, 703, 700, 648, 600, 686, 685, 679, 609, 665, 589, 533, 469, 459, 537, 568, 573, 527, 524, 465, 435, 423, 408, 342, 294, 310, 253, 234, 184, 272, 211, 200, 115, 119, 101, 70, 122, 162, 177, 209, 251, 323, 313, 336, 277, 230, 194, 172, 172, 132, 140, 103, 103, 20, 47, 44, 7, 56, 77, 129, 133, 177, 166, 224, 250, 248, 169, 155 },
        { 615, 569, 596, 578, 622, 603, 613, 613, 622, 665, 641, 626, 657, 731, 763, 769, 729, 723, 651, 640, 654, 607, 647, 634, 599, 556, 603, 571, 533, 441, 394, 439, 458, 427, 418, 353, 299, 339, 347, 298, 216, 167, 248, 338, 329, 255, 190, 204, 199, 169, 141, 146, 66, 51, 64, 70, 15, 60, 78, 116, 162, 130, 150, 135, 143, 190, 185, 166, 215, 196, 245, 212, 292, 279, 303, 288, 211, 206, 194, 204, 175, 117, 158, 126, 97, 90, 129, 200, 184, 142, 203, 208, 184, 150, 155, 178, 210, 145, 198, 234, 290, 268, 336, 259, 345, 338, 331, 263, 216, 221, 229, 285, 317, 382, 389, 377, 448, 472, 491, 511, 554, 518, 556, 620, 590, 550, 540, 481, 423, 349, 321, 305, 282, 295, 294, 288, 295, 263, 244, 240, 308, 292, 271, 276, 270, 258, 240, 189, 250, 205, 188, 151, 171, 170, 173, 122, 107, 55, 16, 10, 10, 15, 10, 10, 21, 82, 91, 108, 139, 154, 201, 211, 167, 194, 148, 166, 167, 167, 206, 205, 248, 179, 251, 222, 167, 135, 120, 179, 189, 177, 145, 209, 209, 232, 164, 143, 176, 110, 109, 79, 108, 80, 166, 206, 212, 209, 190, 272, 305, 358, 346, 266, 288, 316, 330, 282, 261, 234, 279, 237, 268, 246, 243, 255, 231, 231, 220, 178, 191, 198, 236, 158, 250, 224, 146, 129, 101, 87, 134, 190, 128, 195, 201, 230, 168, 127, 141, 119, 74, 89, 95, 40, 46, 21, 15, 21, 11, 65, 41, 32, 10, 40, 10, 59, 47, 140, 187, 226, 269, 226, 158, 119, 83, 9, 10, 15, 10, 44, 15, 107, 42, 140, 167, 222, 175, 150, 131, 136, 125, 167, 207, 198, 237, 214, 240, 232, 141, 101, 21, 62, 101 },
        { 576, 601, 556, 610, 659, 626, 628, 694, 713, 645, 626, 653, 622, 570, 532, 540, 480, 509, 494, 441, 426, 368, 394, 388, 332, 356, 410, 359, 362, 382, 465, 419, 359, 293, 284, 284, 311, 304, 294, 257, 315, 256, 215, 251, 207, 234, 289, 221, 247, 153, 178, 166, 220, 277, 303, 363, 309, 295, 348, 343, 363, 302, 299, 267, 296, 311, 300, 285, 294, 295, 297, 370, 327, 318, 380, 374, 323, 277, 331, 410, 424, 480, 535, 621, 646, 699, 674, 656, 590, 574, 511, 476, 505, 540, 508, 519, 562, 551, 642, 602, 606, 579, 585, 589, 606, 628, 618, 624, 562, 594, 639, 645, 642, 613, 602, 564, 536, 550, 531, 542, 548, 539, 605, 639, 594, 531, 483, 522, 520, 469, 547, 528, 516, 507, 520, 557, 528, 469, 441, 379, 296, 254, 308, 251, 239, 278, 287, 254, 259, 243, 155, 206, 207, 190, 199, 265, 291, 366, 372, 288, 302, 219, 217, 282, 355, 325, 313, 394, 347, 336, 407, 370, 382, 411, 342, 326, 300, 288, 313, 265, 232, 247, 222, 207, 254, 287, 242, 242, 243, 193, 241, 278, 217, 267, 298, 297, 228, 285, 326, 274, 238, 245, 195, 245, 293, 369, 403, 394, 329, 267, 318, 324, 290, 245, 221, 277, 324, 302, 241, 248, 186, 148, 215, 143, 69, 10, 31, 1, 7, 76, 49, 64, 36, 38, 10, 10, 10, 11, 10, 10, 3, 10, 80, 130, 176, 128, 146, 185, 157, 186, 209, 228, 224, 200, 219, 203, 160, 68, 20, 18, 25, 10, 34, 29, 7, 10, 10, 27, 8, 11, 45, 56, 10, 51, 140, 207, 153, 143, 116, 99, 116, 142, 180, 155, 158, 180, 203, 204, 188, 237, 237, 237, 181, 147, 114, 46, 95, 141, 107, 46, 10 },
        { 685, 665, 727, 733, 694, 670, 682, 731, 711, 676, 696, 739, 683, 660, 643, 676, 681, 652, 677, 591, 573, 570, 560, 606, 545, 615, 667, 679, 644, 708, 628, 685, 711, 737, 744, 747, 710, 676, 727, 772, 780, 808, 857, 874, 850, 846, 874, 916, 932, 890, 853, 818, 826, 834, 791, 769, 814, 868, 888, 871, 864, 963, 913, 956, 969, 947, 964, 918, 960, 1014, 920, 915, 849, 832, 833, 825, 819, 819, 749, 728, 776, 698, 748, 736, 695, 684, 637, 617, 608, 533, 590, 620, 635, 615, 591, 623, 608, 603, 680, 663, 641, 636, 622, 699, 624, 668, 615, 555, 582, 607, 592, 669, 655, 645, 647, 592, 575, 628, 651, 649, 595, 562, 557, 589, 583, 560, 584, 607, 642, 613, 615, 594, 613, 621, 657, 701, 722, 676, 662, 664, 738, 812, 761, 829, 849, 874, 814, 868, 860, 887, 924, 974, 956, 908, 943, 1032, 1057, 1012, 996, 910, 960, 930, 942, 944, 952, 930, 925, 901, 927, 847, 833, 785, 782, 767, 780, 733, 804, 792, 802, 747, 745, 704, 712, 626, 634, 598, 609, 556, 529, 551, 537, 445, 430, 415, 469, 442, 436, 462, 469, 490, 437, 397, 343, 339, 334, 358, 366, 360, 287, 290, 287, 323, 308, 278, 258, 302, 359, 403, 427, 406, 441, 488, 440, 438, 431, 440, 390, 406, 396, 435, 414, 377, 363, 411, 415, 422, 383, 349, 404, 397, 340, 409, 330, 351, 313, 325, 250, 269, 342, 343, 385, 441, 445, 473, 517, 502, 433, 440, 454, 512, 523, 555, 512, 494, 512, 574, 565, 594, 554, 630, 644, 588, 529, 507, 504, 494, 504, 509, 496, 482, 503, 454, 520, 542, 590, 565, 585, 553, 575, 513, 545, 528, 528, 490, 506, 533, 544, 493, 568, 499, 554 },
        { 449, 465, 441, 502, 546, 510, 555, 591, 533, 495, 537, 539, 502, 482, 411, 429, 434, 447, 464, 493, 479, 433, 440, 522, 517, 464, 437, 421, 413, 336, 312, 294, 335, 377, 381, 358, 337, 273, 217, 142, 109, 41, 85, 83, 114, 55, 28, 10, 38, 89, 62, 103, 133, 160, 202, 213, 222, 215, 254, 268, 241, 252, 206, 189, 217, 233, 246, 300, 251, 248, 167, 88, 124, 99, 95, 115, 89, 30, 10, 10, 21, 67, 78, 49, 10, 65, 20, 20, 46, 90, 141, 120, 140, 75, 60, 57, 21, 28, 10, 10, 58, 124, 113, 129, 187, 225, 294, 304, 297, 256, 239, 209, 156, 121, 143, 88, 108, 173, 197, 200, 196, 180, 192, 121, 58, 96, 60, 55, 10, 89, 112, 79, 97, 69, 64, 23, 32, 38, 39, 20, 73, 71, 111, 48, 10, 85, 142, 135, 202, 250, 313, 319, 343, 337, 331, 336, 321, 278, 268, 215, 202, 235, 301, 328, 273, 277, 331, 333, 398, 426, 394, 335, 362, 427, 444, 493, 477, 481, 554, 559, 629, 621, 641, 604, 557, 513, 481, 503, 506, 540, 531, 486, 544, 576, 619, 610, 591, 576, 586, 554, 557, 608, 643, 650, 591, 560, 536, 547, 550, 537, 564, 611, 661, 650, 654, 578, 572, 591, 631, 550, 608, 650, 648, 669, 651, 658, 667, 692, 735, 641, 684, 757, 754, 745, 756, 672, 740, 723, 770, 763, 810, 832, 902, 847, 803, 866, 864, 843, 796, 827, 807, 785, 866, 855, 798, 714, 697, 656, 708, 660, 708, 696, 697, 637, 629, 625, 693, 644, 684, 666, 662, 722, 695, 671, 696, 756, 763, 833, 880, 827, 868, 808, 802, 811, 789, 737, 788, 832, 820, 809, 901, 837, 752, 744, 708, 729, 789, 738, 813, 869, 827 },

        { 503, 423, 363, 341, 290, 274, 292, 326, 362, 341, 343, 341, 362, 352, 364, 324, 313, 318, 309, 232, 185, 122, 182, 155, 200, 133, 147, 110, 116, 157, 82, 73, 76, 49, 24, 53, 80, 10, 10, 10, 10, 71, 47, 132, 97, 129, 80, 77, 129, 163, 79, 41, 97, 80, 144, 97, 119, 151, 142, 101, 99, 50, 90, 138, 228, 252, 255, 279, 261, 246, 206, 267, 237, 216, 254, 235, 233, 179, 177, 245, 317, 322, 310, 316, 303, 305, 323, 283, 295, 230, 136, 84, 40, 38, 6, 10, 16, 23, 40, 41, 10, 22, 10, 10, 23, 10, 8, 14, 5, 16, 10, 10, 18, 3, 38, 10, 12, 34, 36, 83, 42, 5, 72, 49, 34, 24, 37, 43, 91, 83, 125, 212, 257, 321, 380, 380, 456, 395, 429, 434, 484, 487, 568, 507, 569, 647, 661, 667, 690, 692, 693, 734, 677, 645, 693, 725, 649, 625, 668, 688, 735, 751, 758, 808, 735, 801, 804, 808, 816, 737, 757, 785, 730, 699, 719, 704, 665, 717, 734, 755, 728, 737, 736, 697, 710, 747, 737, 696, 773, 839, 830, 831, 761, 776, 743, 696, 638, 685, 634, 609, 567, 550, 581, 637, 588, 572, 539, 565, 634, 577, 583, 521, 493, 524, 568, 604, 582, 570, 575, 551, 601, 602, 625, 544, 538, 564, 581, 580, 521, 557, 600, 602, 571, 518, 528, 500, 500, 527, 520, 521, 535, 557, 561, 580, 524, 523, 514, 501, 422, 467, 468, 497, 477, 506, 546, 533, 537, 587, 565, 513, 458, 450, 489, 430, 519, 450, 517, 475, 478, 521, 484, 438, 401, 392, 431, 428, 401, 410, 366, 306, 328, 250, 305, 341, 317, 379, 425, 433, 423, 447, 396, 399, 446, 455, 506, 425, 390, 347, 292, 321, 252 },
        { 469, 524, 566, 587, 590, 658, 709, 627, 583, 564, 590, 598, 639, 682, 650, 658, 664, 722, 636, 654, 640, 634, 600, 619, 620, 609, 620, 627, 578, 580, 531, 503, 576, 653, 572, 552, 572, 541, 539, 596, 639, 643, 692, 647, 651, 651, 620, 567, 554, 495, 501, 502, 517, 537, 458, 436, 407, 419, 356, 395, 390, 381, 355, 362, 444, 376, 295, 266, 284, 346, 348, 269, 303, 334, 302, 353, 369, 358, 338, 362, 385, 386, 349, 358, 388, 334, 303, 322, 333, 309, 302, 305, 324, 301, 233, 261, 233, 221, 194, 158, 211, 192, 243, 245, 223, 242, 206, 118, 40, 0, 7, 10, 60, 1, 10, 10, 95, 100, 35, 10, 81, 117, 174, 227, 160, 136, 172, 182, 193, 183, 131, 125, 114, 102, 71, 67, 10, 3, 10, 3, 10, 2, 10, 41, 42, 45, 38, 10, 24, 52, 54, 101, 174, 128, 107, 78, 26, 30, 50, 46, 44, 20, 10, 42, 55, 39, 10, 9, 74, 50, 58, 6, 10, 47, 7, 25, 34, 10, 35, 16, 51, 32, 25, 10, 6, 55, 89, 72, 7, 17, 10, 14, 16, 10, 47, 27, 15, 17, 9, 10, 54, 45, 28, 57, 48, 22, 53, 107, 18, 75, 18, 71, 149, 212, 177, 172, 131, 80, 117, 88, 29, 4, 25, 29, 54, 13, 91, 68, 74, 46, 10, 10, 10, 41, 27, 49, 45, 65, 35, 19, 24, 22, 31, 29, 30, 68, 107, 123, 102, 144, 213, 202, 172, 154, 167, 181, 180, 221, 278, 332, 290, 317, 360, 285, 242, 159, 127, 39, 45, 70, 20, 10, 70, 58, 11, 10, 8, 13, 15, 10, 19, 10, 21, 44, 80, 59, 133, 74, 101, 167, 140, 157, 161, 160, 182, 150, 177, 149, 86, 73, 70 },
        { 822, 859, 910, 901, 900, 909, 967, 999, 966, 908, 835, 783, 730, 737, 733, 773, 819, 805, 843, 812, 733, 731, 723, 697, 720, 733, 732, 745, 712, 761, 734, 720, 666, 692, 624, 633, 681, 730, 801, 832, 847, 853, 904, 949, 887, 805, 799, 772, 790, 750, 732, 744, 768, 759, 748, 794, 717, 722, 722, 717, 786, 766, 751, 812, 843, 859, 856, 901, 920, 931, 943, 934, 886, 873, 926, 865, 862, 839, 814, 810, 833, 792, 812, 840, 879, 872, 827, 858, 891, 917, 896, 881, 870, 875, 923, 955, 1015, 1086, 1169, 1123, 1101, 1051, 1061, 990, 1056, 1016, 1095, 1132, 1073, 1100, 1085, 1126, 1127, 1106, 1061, 1002, 1001, 1057, 1043, 989, 996, 1020, 1006, 1066, 1143, 1205, 1208, 1176, 1151, 1139, 1165, 1132, 1124, 1209, 1202, 1234, 1215, 1225, 1312, 1262, 1316, 1316, 1321, 1330, 1327, 1342, 1365, 1372, 1377, 1413, 1455, 1460, 1431, 1342, 1351, 1379, 1362, 1318, 1313, 1314, 1296, 1293, 1256, 1261, 1315, 1388, 1381, 1392, 1381, 1363, 1326, 1312, 1292, 1330, 1272, 1307, 1253, 1187, 1214, 1240, 1223, 1212, 1194, 1223, 1202, 1237, 1203, 1205, 1191, 1214, 1218, 1185, 1209, 1169, 1129, 1194, 1195, 1198, 1265, 1288, 1302, 1389, 1446, 1466, 1537, 1484, 1459, 1477, 1499, 1495, 1500, 1482, 1520, 1486, 1422, 1387, 1380, 1357, 1301, 1284, 1221, 1260, 1335, 1370, 1407, 1446, 1472, 1474, 1502, 1496, 1506, 1523, 1534, 1542, 1534, 1565, 1608, 1603, 1653, 1679, 1712, 1712, 1768, 1807, 1805, 1798, 1765, 1700, 1731, 1778, 1841, 1795, 1844, 1817, 1799, 1834, 1766, 1766, 1724, 1734, 1739, 1676, 1661, 1637, 1675, 1698, 1681, 1671, 1647, 1604, 1581, 1575, 1563, 1573, 1560, 1516, 1548, 1538, 1537, 1559, 1614, 1608, 1683, 1674, 1681, 1644, 1618, 1622, 1670, 1675, 1737, 1686, 1713, 1798, 1815, 1866, 1821, 1867, 1887, 1897, 1951 },
        { 427, 419, 438, 403, 326, 328, 375, 439, 445, 396, 394, 394, 358, 316, 299, 290, 232, 256, 239, 278, 322, 384, 379, 382, 342, 258, 249, 270, 302, 259, 263, 263, 242, 227, 185, 111, 115, 188, 169, 123, 67, 10, 81, 72, 26, 10, 10, 10, 60, 10, 10, 4, 24, 29, 15, 17, 71, 81, 117, 157, 156, 157, 89, 139, 170, 146, 171, 112, 64, 114, 166, 195, 245, 208, 133, 167, 200, 134, 58, 10, 10, 10, 29, 10, 84, 11, 10, 10, 26, 10, 10, 10, 10, 45, 39, 38, 50, 53, 10, 22, 85, 108, 52, 105, 146, 237, 181, 262, 275, 231, 222, 211, 222, 183, 183, 228, 221, 241, 310, 299, 331, 359, 379, 419, 422, 463, 388, 443, 532, 507, 504, 514, 576, 605, 654, 572, 573, 560, 532, 618, 589, 655, 693, 686, 720, 773, 816, 831, 835, 890, 861, 860, 812, 814, 830, 891, 916, 984, 948, 945, 1009, 1040, 1068, 1103, 1044, 1076, 1062, 1082, 1032, 1008, 997, 1033, 1110, 1056, 1062, 1046, 1043, 1050, 1024, 996, 1028, 1054, 996, 997, 1055, 1094, 1160, 1104, 1100, 1132, 1117, 1121, 1194, 1172, 1175, 1201, 1195, 1160, 1205, 1192, 1228, 1243, 1187, 1170, 1182, 1160, 1191, 1158, 1155, 1189, 1183, 1270, 1276, 1280, 1349, 1305, 1309, 1303, 1286, 1261, 1216, 1161, 1120, 1171, 1216, 1141, 1165, 1183, 1195, 1189, 1103, 1017, 996, 990, 1069, 980, 996, 1008, 993, 1084, 1059, 1028, 1060, 1092, 1009, 959, 968, 961, 933, 928, 944, 952, 1000, 959, 981, 932, 983, 1061, 1047, 1093, 1080, 1029, 976, 1035, 1095, 1097, 1140, 1216, 1150, 1145, 1153, 1149, 1210, 1200, 1182, 1187, 1143, 1140, 1055, 1061, 1142, 1169, 1177, 1171, 1220, 1242, 1155, 1172, 1230, 1205, 1190, 1270, 1217, 1213, 1246, 1267, 1299, 1367, 1351, 1382, 1385 },
        { 548, 536, 604, 582, 593, 609, 585, 562, 487, 533, 519, 561, 581, 549, 531, 537, 561, 495, 488, 504, 563, 579, 611, 571, 563, 509, 484, 498, 424, 463, 465, 475, 481, 441, 351, 365, 320, 378, 399, 416, 456, 409, 434, 431, 471, 451, 474, 478, 429, 371, 375, 353, 304, 358, 352, 368, 336, 353, 371, 384, 434, 381, 373, 373, 371, 381, 339, 291, 326, 366, 397, 418, 398, 418, 418, 370, 374, 435, 492, 470, 446, 502, 518, 585, 508, 593, 669, 626, 667, 600, 618, 580, 598, 602, 561, 572, 555, 528, 547, 537, 629, 649, 719, 798, 808, 837, 878, 898, 900, 954, 890, 924, 902, 877, 879, 893, 906, 943, 922, 924, 899, 874, 842, 780, 836, 854, 840, 919, 995, 975, 1007, 1000, 1027, 1051, 1120, 1165, 1153, 1119, 1118, 1168, 1184, 1185, 1157, 1068, 1032, 994, 930, 944, 1004, 1037, 1004, 981, 943, 971, 962, 986, 965, 1031, 1085, 1066, 1018, 1018, 989, 1010, 1052, 966, 929, 870, 946, 927, 893, 914, 986, 1062, 1048, 993, 1009, 1033, 1024, 1087, 1183, 1118, 1091, 1125, 1123, 1166, 1176, 1176, 1151, 1140, 1220, 1203, 1127, 1128, 1139, 1114, 1188, 1232, 1280, 1201, 1201, 1193, 1227, 1240, 1288, 1281, 1200, 1244, 1320, 1245, 1320, 1413, 1406, 1408, 1372, 1367, 1445, 1449, 1463, 1506, 1571, 1538, 1549, 1543, 1480, 1463, 1487, 1468, 1395, 1438, 1361, 1304, 1262, 1279, 1270, 1339, 1341, 1364, 1423, 1399, 1425, 1389, 1418, 1450, 1468, 1494, 1461, 1510, 1438, 1366, 1362, 1431, 1362, 1331, 1261, 1343, 1342, 1257, 1342, 1279, 1281, 1352, 1374, 1299, 1274, 1244, 1273, 1316, 1368, 1277, 1264, 1212, 1185, 1232, 1254, 1266, 1243, 1275, 1194, 1210, 1221, 1188, 1167, 1090, 1052, 1029, 1049, 1073, 1032, 1063, 1063, 1036, 1005, 958, 902, 959, 906, 911, 915, 988, 908 },

        { 380, 378, 374, 411, 412, 440, 477, 390, 407, 459, 414, 384, 370, 356, 434, 362, 355, 341, 331, 295, 271, 257, 222, 202, 220, 181, 217, 189, 129, 42, 62, 88, 118, 51, 57, 28, 10, 10, 10, 10, 1, 46, 10, 31, 5, 75, 37, 107, 74, 84, 124, 170, 158, 162, 221, 200, 145, 136, 168, 125, 85, 90, 68, 40, 49, 10, 25, 39, 74, 31, 7, 7, 17, 67, 1, 76, 44, 35, 71, 78, 69, 35, 21, 71, 114, 74, 10, 10, 10, 10, 13, 19, 10, 41, 17, 64, 69, 38, 39, 10, 15, 12, 10, 35, 5, 10, 10, 55, 46, 71, 126, 177, 189, 179, 184, 223, 236, 285, 237, 234, 215, 132, 138, 179, 133, 71, 139, 61, 59, 74, 47, 45, 97, 123, 113, 76, 148, 166, 187, 203, 169, 125, 92, 103, 84, 9, 18, 65, 38, 71, 95, 27, 10, 31, 34, 46, 10, 10, 10, 10, 15, 12, 10, 10, 10, 10, 81, 119, 97, 119, 69, 141, 123, 52, 49, 45, 10, 10, 53, 63, 10, 54, 59, 2, 48, 23, 11, 13, 16, 10, 10, 10, 14, 67, 94, 97, 139, 177, 214, 156, 113, 106, 146, 111, 111, 133, 92, 106, 89, 62, 146, 75, 98, 109, 109, 164, 177, 170, 93, 87, 24, 59, 63, 54, 1, 10, 8, 14, 10, 10, 10, 77, 83, 67, 86, 65, 39, 10, 20, 10, 10, 39, 10, 10, 36, 68, 75, 68, 127, 96, 130, 171, 203, 165, 133, 168, 216, 259, 224, 150, 110, 13, 10, 50, 41, 124, 70, 68, 30, 25, 59, 49, 106, 54, 54, 57, 138, 207, 143, 157, 137, 126, 113, 106, 118, 120, 108, 103, 93, 147, 125, 154, 190, 187, 266, 285, 326, 339, 258, 228, 282 },
        { 542, 573, 629, 596, 593, 518, 612, 663, 679, 630, 541, 584, 520, 522, 486, 521, 443, 456, 445, 403, 415, 394, 391, 351, 369, 368, 292, 218, 215, 198, 274, 286, 299, 309, 368, 359, 338, 346, 354, 397, 452, 407, 389, 338, 388, 303, 353, 325, 345, 409, 435, 430, 376, 391, 379, 367, 391, 427, 368, 349, 357, 311, 325, 239, 247, 316, 332, 325, 383, 363, 354, 361, 347, 272, 232, 297, 315, 300, 289, 288, 288, 243, 226, 263, 254, 290, 333, 346, 378, 337, 291, 357, 405, 402, 364, 413, 400, 349, 326, 301, 279, 293, 247, 187, 201, 147, 189, 166, 201, 166, 207, 297, 349, 350, 327, 347, 402, 443, 450, 512, 525, 514, 511, 541, 518, 450, 492, 426, 399, 425, 413, 423, 407, 416, 387, 394, 302, 321, 314, 325, 288, 326, 357, 352, 378, 416, 368, 351, 372, 372, 323, 292, 362, 319, 351, 420, 475, 520, 564, 542, 557, 533, 600, 538, 524, 556, 536, 538, 508, 571, 551, 536, 570, 621, 665, 657, 698, 742, 770, 770, 802, 815, 833, 794, 799, 853, 813, 813, 758, 741, 734, 799, 733, 776, 705, 733, 730, 646, 669, 591, 528, 535, 536, 489, 558, 483, 526, 521, 473, 437, 491, 533, 528, 573, 654, 588, 610, 546, 528, 539, 549, 615, 560, 500, 450, 418, 372, 325, 318, 315, 322, 290, 335, 345, 332, 305, 270, 216, 263, 281, 225, 230, 137, 82, 41, 8, 22, 10, 32, 63, 123, 184, 190, 200, 226, 274, 188, 180, 204, 190, 144, 187, 159, 122, 53, 50, 56, 87, 174, 168, 152, 160, 130, 172, 146, 126, 95, 105, 59, 110, 186, 184, 243, 209, 273, 273, 296, 333, 314, 377, 370, 331, 355, 342, 299, 341, 370, 364, 317, 234, 292 },
        { 489, 497, 514, 567, 538, 526, 594, 572, 585, 604, 591, 523, 470, 491, 470, 456, 517, 572, 576, 626, 627, 681, 692, 687, 727, 725, 770, 797, 796, 781, 790, 804, 813, 716, 720, 765, 772, 747, 779, 781, 841, 896, 887, 909, 898, 840, 919, 972, 1005, 952, 919, 885, 924, 925, 989, 1025, 981, 1013, 1058, 1080, 1116, 1105, 1102, 1188, 1201, 1173, 1189, 1151, 1221, 1230, 1238, 1190, 1230, 1188, 1243, 1272, 1288, 1306, 1330, 1415, 1340, 1298, 1291, 1242, 1223, 1263, 1288, 1298, 1315, 1317, 1351, 1388, 1355, 1442, 1397, 1319, 1293, 1317, 1291, 1271, 1312, 1277, 1351, 1446, 1436, 1392, 1377, 1386, 1345, 1386, 1395, 1360, 1423, 1463, 1494, 1580, 1561, 1474, 1513, 1467, 1426, 1367, 1347, 1413, 1435, 1432, 1405, 1381, 1401, 1443, 1408, 1346, 1378, 1356, 1328, 1359, 1343, 1355, 1339, 1296, 1347, 1443, 1503, 1515, 1452, 1417, 1419, 1392, 1313, 1298, 1248, 1247, 1272, 1285, 1340, 1339, 1275, 1352, 1369, 1331, 1301, 1342, 1314, 1396, 1326, 1281, 1265, 1225, 1256, 1314, 1333, 1300, 1293, 1264, 1240, 1183, 1187, 1207, 1201, 1194, 1173, 1241, 1179, 1158, 1179, 1194, 1122, 1120, 1190, 1235, 1212, 1178, 1229, 1293, 1277, 1231, 1279, 1313, 1361, 1378, 1381, 1336, 1332, 1294, 1341, 1298, 1280, 1255, 1276, 1293, 1285, 1271, 1313, 1308, 1288, 1318, 1371, 1445, 1446, 1367, 1428, 1455, 1437, 1475, 1427, 1419, 1505, 1501, 1500, 1454, 1404, 1340, 1281, 1315, 1297, 1299, 1277, 1315, 1287, 1211, 1157, 1123, 1168, 1096, 1017, 1024, 1042, 1027, 1090, 1079, 1054, 1048, 1016, 1089, 1018, 1014, 980, 954, 987, 970, 1005, 956, 953, 1006, 1056, 1013, 1094, 1041, 1063, 1036, 1043, 1021, 1022, 938, 950, 946, 979, 920, 953, 998, 1024, 1045, 1035, 1110, 1107, 1084, 1096, 1087, 1132, 1153, 1229, 1255, 1259, 1192, 1224, 1189, 1230, 1253, 1281, 1302, 1378 },
        { 511, 528, 572, 551, 528, 592, 555, 526, 527, 538, 484, 487, 534, 491, 566, 655, 711, 617, 566, 546, 478, 509, 463, 430, 432, 475, 461, 422, 383, 435, 437, 423, 350, 311, 276, 279, 236, 244, 298, 328, 262, 179, 177, 205, 221, 222, 256, 323, 313, 271, 273, 238, 196, 173, 174, 237, 288, 274, 297, 265, 280, 276, 345, 321, 322, 317, 339, 408, 383, 390, 383, 345, 321, 317, 341, 337, 335, 265, 206, 203, 280, 280, 239, 194, 135, 206, 131, 55, 44, 6, 35, 6, 10, 10, 10, 13, 10, 10, 15, 2, 10, 44, 38, 42, 10, 10, 5, 42, 40, 42, 10, 10, 54, 69, 15, 12, 40, 63, 10, 32, 61, 31, 39, 75, 109, 144, 99, 126, 73, 68, 104, 110, 76, 74, 78, 103, 103, 117, 103, 80, 98, 47, 11, 16, 32, 118, 73, 110, 54, 10, 10, 2, 10, 10, 14, 8, 42, 20, 21, 10, 55, 19, 28, 34, 10, 10, 16, 81, 85, 106, 109, 93, 120, 176, 183, 241, 267, 234, 205, 194, 200, 237, 233, 277, 300, 259, 213, 154, 190, 132, 148, 186, 200, 124, 134, 165, 102, 144, 158, 187, 150, 222, 210, 161, 159, 212, 238, 222, 253, 290, 312, 311, 312, 364, 388, 400, 402, 440, 408, 444, 451, 398, 363, 368, 321, 316, 349, 346, 410, 315, 261, 215, 201, 201, 216, 192, 221, 255, 343, 315, 343, 294, 323, 273, 221, 280, 253, 291, 316, 340, 323, 305, 288, 244, 290, 244, 234, 192, 256, 272, 185, 162, 146, 194, 180, 253, 276, 265, 322, 343, 365, 442, 418, 377, 429, 446, 414, 387, 346, 371, 410, 387, 362, 365, 332, 359, 384, 386, 436, 433, 398, 366, 431, 429, 472, 420, 495, 522, 506, 494, 517 },
        { 595, 600, 611, 657, 574, 620, 618, 552, 565, 585, 657, 642, 644, 573, 492, 492, 500, 564, 563, 553, 554, 501, 546, 548, 537, 566, 593, 603, 638, 694, 746, 750, 802, 777, 802, 801, 728, 729, 705, 747, 785, 799, 802, 752, 722, 658, 682, 718, 745, 736, 680, 744, 740, 746, 706, 652, 665, 658, 733, 769, 761, 793, 775, 760, 728, 810, 793, 799, 829, 849, 869, 904, 975, 1010, 1019, 1002, 1009, 1005, 975, 1009, 1020, 1011, 1066, 1078, 1105, 1103, 1087, 1043, 1067, 1112, 1116, 1088, 1145, 1193, 1118, 1117, 1138, 1157, 1196, 1186, 1123, 1079, 1084, 1077, 1095, 1118, 1173, 1123, 1064, 1037, 1050, 1074, 1095, 1091, 1103, 1156, 1135, 1143, 1139, 1122, 1049, 978, 960, 985, 1044, 989, 925, 839, 869, 949, 924, 963, 994, 1056, 1027, 1091, 1108, 1165, 1207, 1238, 1274, 1280, 1261, 1332, 1334, 1331, 1364, 1346, 1378, 1399, 1434, 1372, 1431, 1423, 1369, 1404, 1366, 1357, 1297, 1290, 1374, 1337, 1314, 1359, 1347, 1436, 1429, 1429, 1440, 1456, 1461, 1491, 1447, 1512, 1478, 1453, 1438, 1394, 1329, 1381, 1411, 1371, 1317, 1323, 1383, 1390, 1417, 1459, 1489, 1544, 1546, 1585, 1593, 1583, 1579, 1575, 1497, 1489, 1442, 1424, 1488, 1531, 1509, 1530, 1594, 1546, 1506, 1507, 1529, 1465, 1503, 1495, 1484, 1493, 1532, 1468, 1503, 1494, 1485, 1538, 1530, 1505, 1481, 1493, 1446, 1441, 1520, 1540, 1522, 1478, 1532, 1519, 1438, 1421, 1381, 1427, 1349, 1387, 1374, 1322, 1320, 1249, 1239, 1228, 1249, 1234, 1285, 1228, 1250, 1234, 1208, 1181, 1128, 1112, 1136, 1151, 1161, 1129, 1108, 1145, 1092, 1162, 1170, 1108, 1155, 1204, 1291, 1333, 1294, 1350, 1360, 1407, 1479, 1511, 1522, 1488, 1458, 1370, 1368, 1342, 1300, 1367, 1312, 1327, 1381, 1368, 1272, 1282, 1246, 1184, 1133, 1172, 1168, 1217, 1239, 1186, 1169, 1153, 1179, 1200, 1177 },

        { 9777, 1773, 1801, 1787, 1811, 1783, 1808, 1798, 1747, 1660, 1757, 1770, 1799, 1745, 1781, 1759, 1724, 1665, 1632, 1605, 1565, 1525, 1523, 1515, 1507, 1454, 1440, 1423, 1371, 1373, 1340, 1356, 1290, 1289, 1374, 1462, 1468, 1477, 1491, 1435, 1444, 1482, 1511, 1547, 1558, 1547, 1611, 1620, 1636, 1666, 1636, 1641, 1625, 1657, 1643, 1604, 1597, 1623, 1548, 1551, 1531, 1602, 1643, 1684, 1656, 1655, 1614, 1620, 1650, 1642, 1641, 1616, 1630, 1632, 1711, 1703, 1632, 1640, 1633, 1691, 1735, 1819, 1786, 1779, 1698, 1726, 1751, 1745, 1731, 1768, 1780, 1702, 1776, 1769, 1798, 1790, 1845, 1825, 1844, 1886, 1928, 1859, 1901, 1909, 1977, 2022, 2048, 2041, 2018, 2055, 2055, 2046, 1983, 1971, 1924, 1963, 2000, 2062, 2036, 2049, 2019, 2036, 2097, 2082, 2165, 2158, 2163, 2240, 2210, 2204, 2162, 2184, 2171, 2174, 2172, 2132, 2175, 2171, 2156, 2111, 2128, 2126, 2116, 2134, 2181, 2241, 2272, 2279, 2268, 2345, 2405, 2414, 2366, 2333, 2328, 2301, 2279, 2212, 2159, 2156, 2232, 2260, 2344, 2392, 2338, 2423, 2382, 2377, 2384, 2412, 2421, 2447, 2494, 2483, 2489, 2498, 2465, 2382, 2417, 2407, 2389, 2402, 2306, 2276, 2209, 2199, 2188, 2191, 2174, 2212, 2137, 2200, 2153, 2185, 2174, 2257, 2218, 2273, 2258, 2320, 2288, 2197, 2212, 2298, 2224, 2289, 2280, 2254, 2265, 2245, 2240, 2264, 2196, 2246, 2279, 2263, 2185, 2138, 2072, 2094, 2122, 2090, 2039, 2049, 2077, 2133, 2145, 2168, 2150, 2173, 2237, 2191, 2117, 2055, 2003, 2017, 2003, 1992, 1977, 1992, 1928, 1895, 1908, 1878, 1961, 1994, 2063, 2006, 2024, 2049, 2055, 2064, 2074, 2058, 1987, 2001, 1984, 1974, 2059, 2026, 2077, 2072, 2027, 2054, 2107, 2092, 2123, 2051, 2005, 2092, 2120, 2062, 2024, 1951, 1906, 1935, 1949, 2017, 2057, 2091, 2119, 2094, 2087, 2032, 2053, 2032, 2070, 2050, 2026, 2043, 2113, 2094, 2107, 2059, 2010, 2012, 1997, 2019, 2095, 2170, 2130 },
        { 9777, 1773, 1801, 1787, 1811, 1783, 1808, 1798, 1747, 1660, 1757, 1770, 1799, 1745, 1781, 1759, 1724, 1665, 1632, 1605, 1565, 1525, 1523, 1515, 1507, 1454, 1440, 1423, 1371, 1373, 1340, 1356, 1290, 1289, 1374, 1462, 1468, 1477, 1491, 1435, 1444, 1482, 1511, 1547, 1558, 1547, 1611, 1620, 1636, 1666, 1636, 1641, 1625, 1657, 1643, 1604, 1597, 1623, 1548, 1551, 1531, 1602, 1643, 1684, 1656, 1655, 1614, 1620, 1650, 1642, 1641, 1616, 1630, 1632, 1711, 1703, 1632, 1640, 1633, 1691, 1735, 1819, 1786, 1779, 1698, 1726, 1751, 1745, 1731, 1768, 1780, 1702, 1776, 1769, 1798, 1790, 1845, 1825, 1844, 1886, 1928, 1859, 1901, 1909, 1977, 2022, 2048, 2041, 2018, 2055, 2055, 2046, 1983, 1971, 1924, 1963, 2000, 2062, 2036, 2049, 2019, 2036, 2097, 2082, 2165, 2158, 2163, 2240, 2210, 2204, 2162, 2184, 2171, 2174, 2172, 2132, 2175, 2171, 2156, 2111, 2128, 2126, 2116, 2134, 2181, 2241, 2272, 2279, 2268, 2345, 2405, 2414, 2366, 2333, 2328, 2301, 2279, 2212, 2159, 2156, 2232, 2260, 2344, 2392, 2338, 2423, 2382, 2377, 2384, 2412, 2421, 2447, 2494, 2483, 2489, 2498, 2465, 2382, 2417, 2407, 2389, 2402, 2306, 2276, 2209, 2199, 2188, 2191, 2174, 2212, 2137, 2200, 2153, 2185, 2174, 2257, 2218, 2273, 2258, 2320, 2288, 2197, 2212, 2298, 2224, 2289, 2280, 2254, 2265, 2245, 2240, 2264, 2196, 2246, 2279, 2263, 2185, 2138, 2072, 2094, 2122, 2090, 2039, 2049, 2077, 2133, 2145, 2168, 2150, 2173, 2237, 2191, 2117, 2055, 2003, 2017, 2003, 1992, 1977, 1992, 1928, 1895, 1908, 1878, 1961, 1994, 2063, 2006, 2024, 2049, 2055, 2064, 2074, 2058, 1987, 2001, 1984, 1974, 2059, 2026, 2077, 2072, 2027, 2054, 2107, 2092, 2123, 2051, 2005, 2092, 2120, 2062, 2024, 1951, 1906, 1935, 1949, 2017, 2057, 2091, 2119, 2094, 2087, 2032, 2053, 2032, 2070, 2050, 2026, 2043, 2113, 2094, 2107, 2059, 2010, 2012, 1997, 2019, 2095, 2170, 2130 },
        { 9777, 1773, 1801, 1787, 1811, 1783, 1808, 1798, 1747, 1660, 1757, 1770, 1799, 1745, 1781, 1759, 1724, 1665, 1632, 1605, 1565, 1525, 1523, 1515, 1507, 1454, 1440, 1423, 1371, 1373, 1340, 1356, 1290, 1289, 1374, 1462, 1468, 1477, 1491, 1435, 1444, 1482, 1511, 1547, 1558, 1547, 1611, 1620, 1636, 1666, 1636, 1641, 1625, 1657, 1643, 1604, 1597, 1623, 1548, 1551, 1531, 1602, 1643, 1684, 1656, 1655, 1614, 1620, 1650, 1642, 1641, 1616, 1630, 1632, 1711, 1703, 1632, 1640, 1633, 1691, 1735, 1819, 1786, 1779, 1698, 1726, 1751, 1745, 1731, 1768, 1780, 1702, 1776, 1769, 1798, 1790, 1845, 1825, 1844, 1886, 1928, 1859, 1901, 1909, 1977, 2022, 2048, 2041, 2018, 2055, 2055, 2046, 1983, 1971, 1924, 1963, 2000, 2062, 2036, 2049, 2019, 2036, 2097, 2082, 2165, 2158, 2163, 2240, 2210, 2204, 2162, 2184, 2171, 2174, 2172, 2132, 2175, 2171, 2156, 2111, 2128, 2126, 2116, 2134, 2181, 2241, 2272, 2279, 2268, 2345, 2405, 2414, 2366, 2333, 2328, 2301, 2279, 2212, 2159, 2156, 2232, 2260, 2344, 2392, 2338, 2423, 2382, 2377, 2384, 2412, 2421, 2447, 2494, 2483, 2489, 2498, 2465, 2382, 2417, 2407, 2389, 2402, 2306, 2276, 2209, 2199, 2188, 2191, 2174, 2212, 2137, 2200, 2153, 2185, 2174, 2257, 2218, 2273, 2258, 2320, 2288, 2197, 2212, 2298, 2224, 2289, 2280, 2254, 2265, 2245, 2240, 2264, 2196, 2246, 2279, 2263, 2185, 2138, 2072, 2094, 2122, 2090, 2039, 2049, 2077, 2133, 2145, 2168, 2150, 2173, 2237, 2191, 2117, 2055, 2003, 2017, 2003, 1992, 1977, 1992, 1928, 1895, 1908, 1878, 1961, 1994, 2063, 2006, 2024, 2049, 2055, 2064, 2074, 2058, 1987, 2001, 1984, 1974, 2059, 2026, 2077, 2072, 2027, 2054, 2107, 2092, 2123, 2051, 2005, 2092, 2120, 2062, 2024, 1951, 1906, 1935, 1949, 2017, 2057, 2091, 2119, 2094, 2087, 2032, 2053, 2032, 2070, 2050, 2026, 2043, 2113, 2094, 2107, 2059, 2010, 2012, 1997, 2019, 2095, 2170, 2130 },
        { 9777, 1773, 1801, 1787, 1811, 1783, 1808, 1798, 1747, 1660, 1757, 1770, 1799, 1745, 1781, 1759, 1724, 1665, 1632, 1605, 1565, 1525, 1523, 1515, 1507, 1454, 1440, 1423, 1371, 1373, 1340, 1356, 1290, 1289, 1374, 1462, 1468, 1477, 1491, 1435, 1444, 1482, 1511, 1547, 1558, 1547, 1611, 1620, 1636, 1666, 1636, 1641, 1625, 1657, 1643, 1604, 1597, 1623, 1548, 1551, 1531, 1602, 1643, 1684, 1656, 1655, 1614, 1620, 1650, 1642, 1641, 1616, 1630, 1632, 1711, 1703, 1632, 1640, 1633, 1691, 1735, 1819, 1786, 1779, 1698, 1726, 1751, 1745, 1731, 1768, 1780, 1702, 1776, 1769, 1798, 1790, 1845, 1825, 1844, 1886, 1928, 1859, 1901, 1909, 1977, 2022, 2048, 2041, 2018, 2055, 2055, 2046, 1983, 1971, 1924, 1963, 2000, 2062, 2036, 2049, 2019, 2036, 2097, 2082, 2165, 2158, 2163, 2240, 2210, 2204, 2162, 2184, 2171, 2174, 2172, 2132, 2175, 2171, 2156, 2111, 2128, 2126, 2116, 2134, 2181, 2241, 2272, 2279, 2268, 2345, 2405, 2414, 2366, 2333, 2328, 2301, 2279, 2212, 2159, 2156, 2232, 2260, 2344, 2392, 2338, 2423, 2382, 2377, 2384, 2412, 2421, 2447, 2494, 2483, 2489, 2498, 2465, 2382, 2417, 2407, 2389, 2402, 2306, 2276, 2209, 2199, 2188, 2191, 2174, 2212, 2137, 2200, 2153, 2185, 2174, 2257, 2218, 2273, 2258, 2320, 2288, 2197, 2212, 2298, 2224, 2289, 2280, 2254, 2265, 2245, 2240, 2264, 2196, 2246, 2279, 2263, 2185, 2138, 2072, 2094, 2122, 2090, 2039, 2049, 2077, 2133, 2145, 2168, 2150, 2173, 2237, 2191, 2117, 2055, 2003, 2017, 2003, 1992, 1977, 1992, 1928, 1895, 1908, 1878, 1961, 1994, 2063, 2006, 2024, 2049, 2055, 2064, 2074, 2058, 1987, 2001, 1984, 1974, 2059, 2026, 2077, 2072, 2027, 2054, 2107, 2092, 2123, 2051, 2005, 2092, 2120, 2062, 2024, 1951, 1906, 1935, 1949, 2017, 2057, 2091, 2119, 2094, 2087, 2032, 2053, 2032, 2070, 2050, 2026, 2043, 2113, 2094, 2107, 2059, 2010, 2012, 1997, 2019, 2095, 2170, 2130 },
        { 9777, 1773, 1801, 1787, 1811, 1783, 1808, 1798, 1747, 1660, 1757, 1770, 1799, 1745, 1781, 1759, 1724, 1665, 1632, 1605, 1565, 1525, 1523, 1515, 1507, 1454, 1440, 1423, 1371, 1373, 1340, 1356, 1290, 1289, 1374, 1462, 1468, 1477, 1491, 1435, 1444, 1482, 1511, 1547, 1558, 1547, 1611, 1620, 1636, 1666, 1636, 1641, 1625, 1657, 1643, 1604, 1597, 1623, 1548, 1551, 1531, 1602, 1643, 1684, 1656, 1655, 1614, 1620, 1650, 1642, 1641, 1616, 1630, 1632, 1711, 1703, 1632, 1640, 1633, 1691, 1735, 1819, 1786, 1779, 1698, 1726, 1751, 1745, 1731, 1768, 1780, 1702, 1776, 1769, 1798, 1790, 1845, 1825, 1844, 1886, 1928, 1859, 1901, 1909, 1977, 2022, 2048, 2041, 2018, 2055, 2055, 2046, 1983, 1971, 1924, 1963, 2000, 2062, 2036, 2049, 2019, 2036, 2097, 2082, 2165, 2158, 2163, 2240, 2210, 2204, 2162, 2184, 2171, 2174, 2172, 2132, 2175, 2171, 2156, 2111, 2128, 2126, 2116, 2134, 2181, 2241, 2272, 2279, 2268, 2345, 2405, 2414, 2366, 2333, 2328, 2301, 2279, 2212, 2159, 2156, 2232, 2260, 2344, 2392, 2338, 2423, 2382, 2377, 2384, 2412, 2421, 2447, 2494, 2483, 2489, 2498, 2465, 2382, 2417, 2407, 2389, 2402, 2306, 2276, 2209, 2199, 2188, 2191, 2174, 2212, 2137, 2200, 2153, 2185, 2174, 2257, 2218, 2273, 2258, 2320, 2288, 2197, 2212, 2298, 2224, 2289, 2280, 2254, 2265, 2245, 2240, 2264, 2196, 2246, 2279, 2263, 2185, 2138, 2072, 2094, 2122, 2090, 2039, 2049, 2077, 2133, 2145, 2168, 2150, 2173, 2237, 2191, 2117, 2055, 2003, 2017, 2003, 1992, 1977, 1992, 1928, 1895, 1908, 1878, 1961, 1994, 2063, 2006, 2024, 2049, 2055, 2064, 2074, 2058, 1987, 2001, 1984, 1974, 2059, 2026, 2077, 2072, 2027, 2054, 2107, 2092, 2123, 2051, 2005, 2092, 2120, 2062, 2024, 1951, 1906, 1935, 1949, 2017, 2057, 2091, 2119, 2094, 2087, 2032, 2053, 2032, 2070, 2050, 2026, 2043, 2113, 2094, 2107, 2059, 2010, 2012, 1997, 2019, 2095, 2170, 2130 }

    };

    public Player(){
    }

    public Player(int id){
        m_id = id;

        m_currentGopIndex = -1;
        m_join = false;
        m_avrPLR = 0;
        m_weightedAvrPLR = 0;
        m_joinTime = -1;

        // auction
        m_sendBid = false;
        m_getBidResults = false;
        m_allocPkt_LTE = 0;
        m_optPkt_LTE = 0;
        m_isOffloaded = false;
        m_binaryOffloading = false;
        m_isSamewithPreviousBid = false;
        m_isMyTurn = false;
        m_omega = -1; // revision

        m_upperBoundPkt = 0;
        m_lowerBoundPkt = 0;

        // network initialization
        // LTE
        m_recvPktTime_LTE = -1; // start at 1 second
        m_sendPktNum_LTE = 0;
        m_sendTotalPktNum_LTE = 0;
        m_recvPktNum_LTE = 0;
        m_recvTotalPktNum_LTE = 0;
        m_recvPktTotalTime_LTE = 0;
        m_sizeByte_LTE = 0;
        m_sizeByteTotal_LTE = 0;
        m_plr_LTE = 0.05;
        m_weightedPlr_LTE = 0.05;
        m_rtt_LTE = 10;
        m_estimatedRtt_LTE = 10;
        m_bw_LTE = 0; // kbps
        m_bwEst_LTE = 0;
        m_bwSumLTE = 0;
        m_cellID = -1; // 20170308 major revision
        // m_vec_bw_LTE.push_back(m_bw_LTE);

        // WiFi
        m_recvPktTime_WiFi = -1;
        m_sendPktNum_WiFi = 0;
        m_sendTotalPktNum_WiFi = 0;
        m_recvPktNum_WiFi = 0;
        m_recvTotalPktNum_WiFi = 0;
        m_recvPktTotalTime_WiFi = 0;
        m_sizeByte_WiFi = 0;
        m_sizeByteTotal_WiFi = 0;
        m_plr_WiFi = 0.05;
        m_weightedPlr_WiFi = 0.05;
        m_rtt_WiFi = 10;
        m_estimatedRtt_WiFi = 10;
        m_bw_WiFi = 0;
        m_bwEst_WiFi = 0;
        m_bwSumWiFi = 0;
        //m_vec_bw_WiFi.push_back(m_bw_WiFi);

        // Bargaining
        m_qualBP = 0;
        m_socialBP = 0;
        m_BP = 0;
        m_macroRsc = 0;
        m_smallRsc = 0;
        m_A = 0;
        m_B = 0;
    }

    ////////////////////////////////////////////////////////
    //////////////           system         ////////////////
    ////////////////////////////////////////////////////////
    static double MinHo(double a, double b){
        return a<b ? a:b;
    }

    static double MaxHo(double a, double b) {
        return a>b ? a:b;
    }

    static double roundUp(double x, int pos) {
        double buffer = Math.pow(10.0, (double) pos);
        x *= buffer;
        x += 0.5;
        x = Math.floor(x);
        x /= buffer;
        return x;
    }

    static double phi(double x) {
        return Math.exp(-x * x / 2) / Math.sqrt(2 * PIVALUE);
    }

    static double Phi(double z) {
        //NS_LOG_FUNCTION(z);
        if (z < -8.0) {
            return 0.0;
        }
        if (z > 8.0) {
            return 1.0;
        }
        double sum = 0.0;
        double term = z;
        for (int i = 3; sum + term != sum; i += 2) {
            sum = sum + term;
            term = term * z * z / i;
        }
        return 0.5 + sum * phi(z);
    }

    static double Phi(double z, double mu, double sigma) {
        //NS_LOG_FUNCTION(z<<mu<<sigma);
        if (z == mu) {
            return 1;
        } else {
            return Phi((z - mu) / sigma);
        }
    }

    static double calculateBlockLossRate(int pktTotal, double packetMin, double avrPLR) {
        return Phi(packetMin, pktTotal * (1 - avrPLR), Math.sqrt(pktTotal * (1 - avrPLR) * avrPLR));

    }
    static double calculateCoderate(int pktTotal, double avrPLR) {
        double packetMin;
        double coderate = 0;
        double gPacket;
        double gPacketOPT = 1;
        double calcResult;

        for (double i = CODERATE_MAX; i > CODERATE_MIN; i -= CODERATE_STEP) {

            roundUp(i, 3);
            packetMin = pktTotal * i;

            calcResult = calculateBlockLossRate(pktTotal, packetMin, avrPLR);

            if (calcResult <= FOUNTAIN_CONSTRAINTS) {
                gPacket = FOUNTAIN_CONSTRAINTS - calcResult;
                if (gPacket < gPacketOPT) {
                    coderate = i;
                    gPacketOPT = gPacket;
                }
            }
        }
        return MaxHo(coderate, CODERATE_MIN);
    }

    ////////////////////////////////////////////////////////
    //////////////       end of system      ////////////////
    ////////////////////////////////////////////////////////

    double getBETA(int gopIndex){
        return BETA[m_id % NUMBER_OF_VIDEO][gopIndex];
    }


    void setCellID (short id) {
        m_cellID = id;
    }

    short getCellID () {
        return m_cellID;
    }

    void addBwWiFi (int bw) {
        m_vec_bw_WiFi.add(bw);
    }

    void addBwLTE (int bw) {
        m_vec_bw_LTE.add(bw);
    }

    Vector getVecBwWiFi () {
        return m_vec_bw_WiFi;
    }

    Vector getVecBwLTE () {
        return m_vec_bw_LTE;
    }

    void setJoin (boolean join, double joinTime) {
        m_join = join;
        if (m_id == 0) {
            if (WITH_BINARY_LTE_OFFLOADING || WITH_BINARY_WIFI_OFFLOADING) {
                m_joinTime = 42;
            }
            else {
                m_joinTime = -30;
            }
        }
        else {
            m_joinTime = joinTime;
        }

        //m_joinTime = joinTime;
        m_joinTime = 0; // park
    }

    boolean getJoin () {
        return m_join;
    }

    void calculatePktMax () {

        // WiFi
        int remainingTime = DELAY_CONSTRAINTS - m_rtt_WiFi; // ms

        // channel state                revision
        if (m_id <= 1) {
            //                        if(ns3::Simulator::Now().GetSeconds()  == 50)
            //                        {
            //                                m_bwEst_WiFi += 100;
            //                                NS_LOG_FUNCTION(ns3::Simulator::Now().GetSeconds()  << m_id << m_bwEst_WiFi);
            //                        }
            //                        else if(ns3::Simulator::Now().GetSeconds()  == 30)
            //                        {
            //                                m_bwEst_WiFi -= 200;
            //                                NS_LOG_FUNCTION(ns3::Simulator::Now().GetSeconds()  << m_id << m_bwEst_WiFi);
            //                        }
            //                        else if(ns3::Simulator::Now().GetSeconds()  == 10)
            //                        {
            //                                m_bwEst_WiFi -= 700;
            //                                NS_LOG_FUNCTION(ns3::Simulator::Now().GetSeconds()  << m_id << m_bwEst_WiFi);
            //                        }
        }

        double transmissionTime = (double) PACKET_SIZE * 8 / (m_bwEst_WiFi * 1024); // bw(Kbps), sec
        m_maxPkt_WiFi = (int)MaxHo(0, Math.floor((remainingTime / 1000.0) / transmissionTime));

        // LTE
        remainingTime = DELAY_CONSTRAINTS - m_rtt_LTE; // ms
        transmissionTime = (double) PACKET_SIZE * 8 / (m_bwEst_LTE * 1024); // bw(Kbps), sec
        m_maxPkt_LTE = (int)Math.floor((remainingTime / 1000.0) / transmissionTime);
    }

    double PSNRtoMSE (double PSNR) {
        return 255.0 * 255.0 / Math.pow(10, PSNR / 10.0);
    }

    double MSEtoPSNR (double MSE) {
        return 10 * Math.log10(255.0 * 255.0 / MSE);
    }

    double ratetoPSNR (double bitrate, int gopIndex) {
        double distortion = ALPHA[m_id % NUMBER_OF_VIDEO][gopIndex] * Math.pow(bitrate, BETA[m_id % NUMBER_OF_VIDEO][gopIndex]);
        return MSEtoPSNR(distortion);
    }

    boolean isSameWithPreviousBid () {
        return m_isSamewithPreviousBid;
    }

    void initialize () {
        m_optBitrate = 0;
        m_optPSNR = 0;
        m_optDistortion = 0;
        m_optCoderate = 0;
        //m_optPkt_WiFi = 0;
        //m_optPkt_LTE = 0;
        //m_allocPkt_LTE = 0;
        m_omega = -1; // revision

        m_qualBP = 0;
        m_socialBP = 0;
        m_BP = 0;
        m_macroRsc = 0;
        m_smallRsc = 0;
        m_A = 0;
        m_B = 0;
    }

    void initializeNetwork () {
        m_recvPktNum_WiFi = 0;
        m_recvPktNum_LTE = 0;
        m_sendPktNum_WiFi = 0;
        m_sendPktNum_LTE = 0;
        m_sizeByte_WiFi = 0;
        m_sizeByte_LTE = 0;
        m_recvPktTotalTime_LTE = 0;
        m_recvPktTotalTime_WiFi = 0;
        m_bwSumWiFi = 0;
        m_bwSumLTE = 0;
    }

    int getID () {
        return m_id;
    }

//    Ipv4Address getUEAddr () {
//        return m_ueAddr;
//    }

    double getJoinTime () {
        return m_joinTime;
    }

    void setQualBP (double bp){
        m_qualBP = bp;
    }

    void setSocialBP (double bp){
        m_socialBP = bp;
    }

    void setBP (double omega){
        m_BP = omega*m_qualBP + (1-omega)*m_socialBP ;
    }

    double getQualBP (){
        return m_qualBP;
    }

    double getSocialBP (){
        return m_socialBP;
    }

    double getBP (){
        return	m_BP;
    }

    void setMacroRsc (double rsc){
        m_macroRsc = rsc;
    }

    double getMacroRsc (){
        return m_macroRsc;
    }

    double getSmallRsc (int id, int sec){
        //return m_smallRsc;
        return smallRsc[id][sec-10];
    }

}
